String.prototype.format=function(b){var a=this,d;for(d in b)a=a.replace(RegExp("{"+d+"}","igm"),b[d]);return a};
$.widget("my.genequery_autocomplete",$.ui.autocomplete,{options:{mygene_url:"http://mygene.info/v2/query",q:"(symbol:{term} OR symbol: {term}* OR name:{term}* OR alias: {term}* OR summary:{term}*)",species:"human",fields:"name,symbol,taxid,entrezgene",limit:20,gene_label:"{symbol}: {name}",value_attr:"symbol",minLength:2},_create:function(){$.ui.autocomplete.prototype._create.call(this);var b=this.options;this.source=function(a,d){$.ajax({url:b.mygene_url,dataType:"jsonp",jsonp:"callback",data:{q:b.q.format({term:a.term}),
sort:b.sort,limit:b.limit,fields:b.fields,species:b.species},success:function(a){var e={3702:"thale-cress",6239:"nematode",7227:"fruitfly",7955:"zebrafish",8364:"frog",9606:"human",9823:"pig",10090:"mouse",10116:"rat"};0<a.total?d($.map(a.hits,function(a){var c={id:a._id,value:a[b.value_attr]};$.extend(c,a);e[c.taxid]&&(c.species=e[c.taxid]);c.label=b.gene_label.format(c);return c})):d([{label:"no matched gene found.",value:""}])}})};void 0===this.element.attr("title")&&this.element.attr("title",
"Powered by mygene.info");b.select=b.select||this._default_select_callback;this._add_css('.ui-autocomplete-loading { background: white url("'+this._url_root+'img/ui-anim_basic_16x16.gif") right center no-repeat; }')},_url_root:"http://mygene.info/widget/autocomplete/",_add_css:function(b){var a=document.createElement("style");a.type="text/css";a.styleSheet?a.styleSheet.cssText=b:a.appendChild(document.createTextNode(b));document.getElementsByTagName("head")[0].appendChild(a)},_default_select_callback:function(b,
a){alert(a.item?"Selected: "+a.item.label+"("+a.item.id+")":"Nothing selected, input was "+this.value)}});